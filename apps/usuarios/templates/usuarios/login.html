{% extends 'base.html' %}
{% load static %}
{% block title %}Login - Vagalume Carreiras{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/auth.css' %}">
{% endblock %}

{% block content %}
<div class="login-wrapper">
    
    <div class="login-info">
        <h1>Bem-vindo vagalume.</h1>
        <p>Continue a brilhar com milhares de vagas e empresas.</p>
    </div>
    
    <div class="auth-form-container">
        
        <div class="form-toggle">
            <button type="button" class="toggle-btn active" data-form="candidato">Sou Candidato</button>
            <button type="button" class="toggle-btn" data-form="empresa">Sou Empresa</button>
        </div>
        
        <form method="POST" class="auth-form">
            {% csrf_token %}
            
            {% if messages %}
                <div class="messages">
                    {% for message in messages %}
                        <p class="form-error-message">{{ message }}</p>
                    {% endfor %}
                </div>
            {% endif %}

            <div id="form-candidato" class="form-fields active">
                <div>
                    <input type="text" name="username" id="id_username_candidato" placeholder="Email/CPF">
                </div>
            </div>
            
            <div id="form-empresa" class="form-fields">
                <div>
                    <input type="text" name="username_empresa" id="id_username_empresa" placeholder="Email Corporativo / CNPJ" disabled>
                </div>
            </div>

            <div>
                <input type="password" name="password" id="id_password" placeholder="Senha" required>
            </div>

            <button type="submit" class="btn-submit-green">Fazer Login</button>
            
            <p class="form-footer-link">
                <a href="{% url 'recuperar_senha' %}">Não lembra a senha? Clique aqui</a>
            </p>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const toggleButtons = document.querySelectorAll('.toggle-btn');
        const candidatoForm = document.getElementById('form-candidato');
        const empresaForm = document.getElementById('form-empresa');
        
        // Inputs (vamos habilitar/desabilitar para garantir que só um seja enviado)
        const candidatoInput = document.getElementById('id_username_candidato');
        const empresaInput = document.getElementById('id_username_empresa');

        toggleButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Remove 'active' de todos
                toggleButtons.forEach(btn => btn.classList.remove('active'));
                
                // Adiciona 'active' no clicado
                this.classList.add('active');
                
                if (this.dataset.form === 'candidato') {
                    // Mostra o form do candidato
                    candidatoForm.classList.add('active');
                    empresaForm.classList.remove('active');
                    // Habilita o input do candidato e desabilita o da empresa
                    candidatoInput.disabled = false;
                    candidatoInput.name = "username"; // Nome que o backend espera
                    empresaInput.disabled = true;
                    empresaInput.name = "username_disabled";
                } else {
                    // Mostra o form da empresa
                    candidatoForm.classList.remove('active');
                    empresaForm.classList.add('active');
                    // Habilita o input da empresa e desabilita o do candidato
                    candidatoInput.disabled = true;
                    candidatoInput.name = "username_disabled";
                    empresaInput.disabled = false;
                    empresaInput.name = "username"; // Nome que o backend espera
                }
            });
        });
    });
</script>
{% endblock %}