{% extends 'base.html' %}
{% load static %}
{% block title %}Candidatos para {{ vaga.titulo }}{% endblock %}

{% block content %}
<style>
    .container-header { text-align: center; margin-bottom: 30px; }
    .container-header h1 { font-size: 2.5rem; }
    .container-header p { font-size: 1.1rem; color: #8b949e; }

    .candidatos-container {
        max-width: 900px;
        margin: auto;
    }
    
    .candidato-card {
        background: #161B22;
        border: 1px solid #30363d;
        padding: 25px;
        margin-bottom: 15px;
        border-radius: 8px;
        display: flex;
        justify-content: space-between; /* Mantém Score na direita e Info na esquerda */
        align-items: center;
    }

    /* --- NOVO CSS DA FOTO --- */
    .candidato-left-wrapper {
        display: flex;
        align-items: flex-start; /* Alinha topo da foto com topo do texto */
        gap: 20px;
    }

    .candidato-foto {
        width: 60px;
        height: 60px;
        flex-shrink: 0;
        border-radius: 50%;
        background-color: #30363d;
        overflow: hidden;
        border: 2px solid #BEF264; /* Borda neon bonita */
    }
    
    .candidato-foto img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    /* ------------------------ */

    .candidato-info h3 { color: #fff; margin: 0 0 5px 0; font-size: 1.25rem; }
    .candidato-info p { color: #8b949e; margin: 0; font-size: 0.95rem; }
    
    .candidato-match-score { text-align: right; flex-shrink: 0; margin-left: 20px; }
    .candidato-match-score h2 {
        color: #BEF264;
        margin: 0;
        font-size: 2.2rem;
        font-weight: 800;
    }
    .candidato-match-score p { color: #8b949e; margin: 0; font-size: 0.9rem; }
</style>

<div class="candidatos-container">
    <div class="container-header">
        <h1>Candidatos para a vaga</h1>
        <p>"{{ vaga.titulo }}"</p>
    </div>

    {% for item in candidatos_ordenados %}
        <div class="candidato-card">
            
            <div class="candidato-left-wrapper">
                
                <div class="candidato-foto">
                    <img src="https://ui-avatars.com/api/?name={{ item.candidato.usuario.get_full_name }}&background=random&color=fff&size=128" alt="Avatar">
                </div>

                <div class="candidato-info">
                    <h3>{{ item.candidato.usuario.get_full_name }}</h3>
                    <p>{{ item.candidato.headline|default:"Sem headline" }}</p>
                    <p style="font-size: 0.8rem; margin-top: 5px; color: #8b949e;">
                        Aplicou em: {{ item.data_aplicacao }} | Status: {{ item.status }}
                    </p>
                    
                    <div style="margin-top: 15px;">
                        <a href="{% url 'perfil_publico' item.candidato.usuario.username %}" 
                           style="background-color: #2d3f52; color: #fff; padding: 6px 12px; border-radius: 5px; text-decoration: none; font-size: 0.9rem; font-weight: 600;">
                           Ver Perfil Completo
                        </a>
                    </div>
                </div>
            </div>

            <div class="candidato-match-score">
                <h2>{{ item.score|floatformat:0 }}%</h2>
                <p>Compatível</p>
            </div>
        </div>
    {% empty %}
        <p style="text-align: center; color: #8b949e; padding: 20px;">
            Nenhum candidato se aplicou para esta vaga ainda.
        </p>
    {% endfor %}
    
    <div style="text-align: center; margin-top: 30px;">
        <a href="{% url 'home_recrutador' %}" style="color: #8b949e;">&larr; Voltar ao painel</a>
    </div>
</div>
{% endblock %}